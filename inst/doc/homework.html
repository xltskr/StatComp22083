<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22083" />


<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">22083</h4>
<h4 class="date">2022/11/25</h4>



<div id="hw1-2022-09-15" class="section level1">
<h1>hw1-2022-09-15</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span></code></pre></div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.7, 3.12, and 3.13 (pages 94-96, Statistical
Computating with R).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.3</h3>
<p>Denote $u=F(x), $ so <span class="math inline">\(u=1-(\frac
bx)^a\)</span></p>
<p><span class="math inline">\(\quad\quad\because x\geq b&gt;0,
a&gt;0\)</span></p>
<p><span class="math inline">\(\quad\quad\therefore x=b/(1-u)^{\frac
1a}\)</span></p>
<p><span class="math inline">\(\quad\quad\therefore
F^{-1}(u)=b/(1-u)^{\frac 1a}\)</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pareto <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with cdf F(x)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&#39;pink&#39;</span>,<span class="at">main=</span><span class="fu">TeX</span>(<span class="st">&#39;Pareto Distribution: $f(x)=</span><span class="sc">\\</span><span class="st">frac{ab^a}{x^{a+1}}$&#39;</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;sample&#39;</span>,<span class="at">fill=</span><span class="st">&#39;pink&#39;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the density function f(x)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(x), <span class="fl">0.01</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,{a<span class="sc">*</span>(b<span class="sc">^</span>a)}<span class="sc">/</span>{y<span class="sc">^</span>{a<span class="sc">+</span><span class="dv">1</span>}},<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;theoretical&#39;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">pareto</span>(<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.7</h3>
<p>Suppose <span class="math inline">\(X\sim\)</span>Beta<span class="math inline">\((a,b)\)</span>, the density of <span class="math inline">\(X\)</span> is <span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1},\quad
0&lt;x&lt;1.\]</span> It can be obtained that <span class="math display">\[x_0=\underset{x\in(0,1)}{\arg\max}~f(x)=\frac{a-1}{a+b-2}.\]</span>
Let reference density be <span class="math inline">\(g(x)=\pmb
1_{\{0&lt;x&lt;1\}}\)</span>, then <span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\leq
c=f(x_0).\]</span></p>
<p>Based on the <strong>acceptance-rejection algorithm</strong>, our
algorithm is shown below:</p>
<ul>
<li>Generate random numbers <span class="math inline">\(U\sim
U(0,1)\)</span> and <span class="math inline">\(Y\sim g(\cdot)\)</span>,
i.e.Â <span class="math inline">\(Y\sim U(0,1)\)</span>;</li>
<li>if <span class="math inline">\(U\leq\dfrac{f(Y)}{cg(Y)}\)</span>,
then accept <span class="math inline">\(Y\)</span> and return <span class="math inline">\(X=Y\)</span>; otherwise reject <span class="math inline">\(Y\)</span> and continue.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate constant c</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> x0<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x0)<span class="sc">^</span>(b<span class="dv">-1</span>)  <span class="co"># constant in pdf can be ignored</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with pdf f(x)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># random variate from g(x)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> c <span class="sc">&gt;</span> u) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># accept x</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&#39;pink&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&#39;Beta(&#39;</span>,a,<span class="st">&#39;,&#39;</span>,b,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;sample&#39;</span>,<span class="at">fill=</span><span class="st">&#39;pink&#39;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#superimpose the theoretical Beta(3,2) density </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(z,<span class="dv">12</span><span class="sc">*</span>z<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z),<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;theoretical&#39;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">beta</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level3">
<h3>3.12&amp;13</h3>
<p><span class="math inline">\(\because\)</span> the cdf is <span class="math inline">\(F(y)=1-\big(\frac{\beta}{\beta+y}\big)^2,\quad
y\geq 0\)</span></p>
<p><span class="math inline">\(\quad\quad\therefore
f(y)=\frac{r\beta^r}{(\beta+y)^{r+1}},\quad y\geq 0\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>expgamma <span class="ot">&lt;-</span> <span class="cf">function</span>(r, beta) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers from the mixture</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, x)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&#39;pink&#39;</span>,<span class="at">main=</span><span class="st">&#39;Exponential-Gamma Mixture&#39;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;sample&#39;</span>,<span class="at">fill=</span><span class="st">&#39;pink&#39;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#superimpose the theoretical Pareto distribution density </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="fl">0.01</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,r<span class="sc">*</span>beta<span class="sc">^</span>r<span class="sc">/</span>((beta<span class="sc">+</span>y)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>)),<span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="st">&#39;theoretical&#39;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">expgamma</span>(<span class="dv">4</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABJlBMVEUAAAAAABcAACAAACgAACoAADoAAEkAAFgAAGYAIXwAMVEAOjoAOmYAOpAAZpAAZrYNAAAXAAAXZtsgZnwhAAAoAAAqAAAyAAA6AAA6ADo6OgA6Ojo6OmY6Zlg6ZmY6ZpA6ZrY6kJw6kNs6nf9JAABYZjpmAABmADpmFwBmOgBmOjpmZmZmgWZmkLZmkNtmnJBmnZBmtrZmtttmtv9m2/97IAB8ezqQOgCQZgCQZjqQkDqQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/7a2/9u2//+8UQ3beyDbkCrbkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb////tmb/wMv/25D/27b//7b//9v////S3aAwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMKklEQVR4nO2da4PbRhmFVcCwkCzbFEKdFGgw4JBya+LCUijU4lZCFxBNAzTKxtb//xPMTZqxVpqj0SWW5HM+7Fqj0auZx+/cpJlxlFFeRcdOwNhFQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAYUBLlOn/R1133f7rK9peHBkvHz94Td7z14L+d7xUXKZefLm7cV6emVkcB9OrRGQAkDrQWm643k1gWW/Fht64GpFJTq6MAiqOKJLkJL/hEVTFDbya0Eh+ulwpQs9QUagLIXi/uob978VfY/UQUg9tP1RlZIm79/IWKv/j4jyJcfmnZXnxaPCgFqySffaqBPHskDr67PQSUiqueiIPPljpvRSThBRfP7ouT2b+XytaNACdyAegdZVl908aDnIzo1FxpTMLcSqX1o0fR2VOV/CBA8iYr+Wdjspm7b2J9LHHClVcLKlcHwS6gtAh1AImPC53B63ckJxvJGIyi+8a7bgQ4kQtA318q+2e/tUXMZqQSkM6MMt4AUK6NTvpHS5UTYVgw/kx57fWyuKn8K7xKf45lFHHyZrCpg8Sfb77QMRxA0i2cFDiRZJJX8qbRE23rRoATuQD05FIcXS/P/2wBHWREoikBOn+a/UclPxCQLsjq24l1QGyK21X+WfuXiHdhbqd90Al2AMkbPP/L/VLl6WQvl4kkLIpI+m9O7DDAiVwA2sTidBqtEuc+bkYqAG0ycxAKSHnkKivsyvK6zfMmP+s/2glUIoy/O8EuoP2HOoZJuHLq8891TtO82NpI+nr9Nwd0GOBEtoBSVYY2LqByRkp10DZ3hsA6SKR6aYq3ASRyscmLhPzskkgjBEg2V7d/93x9COh/2l4OyImEATmRc0CLrTjzeL3Ypi6gUkb037w6UGf0/QMBqQbYfANNPGhjzVQB0gnalQB9oSvpHJATCQNyIltAJtUuoHJGKgCp5IcCSlR7scp8dVBBwq1sqwGlec20qmzm988fHUbCgJzIFpDpRLuA3IycXeXpSyMHkLIaUgcJO7K5EgVgsfW1Yi4J0UF5tdYnbXBSNOvqwleX5R6u01GMHmROpEYelEd2AKWqwlFNhL6Pk5HE/BUR5HUWkEp+GCDdQVFfRNEPMgUtr1APSJheik2GDpbJ1f2ggkRpCGCHGk+cg6Z1UKmS1l+suL0F5GZEpeaqaFAcQKH9oLOr1Cld4safigbjXacn/Qsd35LIXn24NFHcYNlBvf23ohW7/ftEw3fHMs/fW+Z9cydSw1ZMR3YA6c6/BeRmRKVGdNdEB/zdT9xWTCcfAqqTfwgzGxEQEAEBERAQH7kCERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQENDmjq38Dw6Z84oTbJv16GLME5IUDFuogoZBHOCQHKUj23tosHFYRD7ntMhSV0t9bLHDoAeqk1U0BZFqvZtARUryRaEZBX18tbBOTV/jIioMFucSqAkoApwPIWtgN1IoDKVnzdGwXoZQ7mNAF5zREQMHdKgPLFWLU1UDigKPKWT6t0IzryFc1nVWBIXKAgQEm+zjG9sWzbYw4AelnImxaZt6aZruUwMKD9ZYElqdnH47QBOebTmkLWKyC1SlIvHI6iO1H0jbfv3hWffimCfyz+f0tu7CHXU76VZf8S/76mdi/QS1PlglR5ZWLWZsba0uQ8KPJKjmhSufhTrgP+ynKjFp4m0RsfZP944wNx8JZZtH/3Qpw9/3y5StRIemW9LVHbfay0BfV56DrI2A+qg2RgGw/KvXT3cCu96a4AdEe6x5uCyZvi4HtnV/tfff3Fbv2zLy9/ICikX/3RSl+WA5JsHAs1ZdSv0OdBdnVzc3MtAe3WthwLV5GA7m4UqfRL3xYH70ufWmx36/eXiz+s5RmzHcAmB+Q+dlDr6QcH1M5cS0C6U7FRFcnZX5cuIFMGDaDH68OiaQHd04uXjYXZAZKK5cYbm7yIuR50TxUbx4OyNN8zqOxBxsJEAfk7iiJLqd42yQG0W9/ZyMo42//E1EGP124bVa6DjIVpAqqXcohUe5Co/O6sCkDZP6MfqibNacVEY7f4tdoyQzrVyrZi+8sLY2E1M0BqzwizrcZiG6t+kAF0/bY89R21M1DRD9K7OJmtXA77QdqCJDcdQF3f/4Q9GG+vowHy1cxNNCdAInQGgEo7z3U1VwrtH9DrkpM+PdLrzdxB6CwAZT0wmjugrGgoezKXh84EUKrGPvvL9rvazhmQHKlrMnVPw4LMHYbOANBuXWwP28KKv9s3D0APNZ8O7pPVdquiGQEKeansMVcKnjyg2BaSAZr5GQCyHtSTuVLwDAANao6AkLmpA9qtV8Uk6CEq6ckDGtwcAQFzcwAkn3QnXX9dpJRd23mYAaBYbn99oV5j92FOH5a5TBiQfOAvXx31OtSYG6BYvjkZBlAZzPQAibIll6rs1r4ilpgJO7UY5wxot1a/r+Dlo6bYyBinCAhLT6BSDxwJqEr5i1vR3p0iIDjF107Biy+CAeVEJgwoxs1XjkVUV/0B6vqSfmA5zXyDJ2X5JMX9ZX+ARu5KB/2gHs2ZwxkB8jfwwebM4YwAqXFGY4VX0obEdAF1emBWV9POCdAg5ggImJsXIPVTk7G3sQ9dL3aAIZo4oHSxTeRo3kMoeL3YnADJcUTiGYZmbVb7zAmQ7CjKbHueKIavF5sToNyD4vqn9h09yFKaJCBTByW+7mLwerFZAdJdRf8sqtD1YvMCNIC5EqCIgPyvfSYNSJeebu9V5wwoNq9zOs61B4AiH6BxPlk0ySlWM3ZcIwLerHoBjdOTdHKcp2WDvpufLCBnBDbQq+eiHE0VEBxEhJizhwRUac4eElClOXtYj4GA1OF8ANnH7gMDimq4jBvQUOYICJir7C+fIqAm78XyDycJqM5cJYaIgOxhJaCIgIrDSgwEZA+rAUVeQON67nEMQO5zIV8Xst+ktdRRAL0koPywDsPN1S0EREAV5nxVMQFlfkB1gzICMv/rBmUEVPyv7lJPGlDDGWb1KzEPMVT2GKcMqOkMs3ouJQz+1ayj6FKH3Lzx/KDGgKra+4prOuWwo0Ju3niGWQAg60QzADSEB+nnH1HNGcvwaEUtsA5qNsMsEJBBgK/plNOWCrtpwxlmwYBcRpMG1NBcG0CmrPlciYCsK1VvZ3GMyqjlvfzLoboBKgJu6OaZttlurkFe+9zM2vj0egHNWAQE1PNgdX7qebA6P/U81DBGx6T2bHReAuI2nmbVwOiYovR2fXMP6uW+0wPUYLDa2OiYovR4PRysNjY6piiDXt/W6JiiDHp9W6NjijLo9W2NjinKoNe3NTqmKINe39bomKIMev3sRUBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQE1D+gFG1jpV8/4hdrnt3UlK6XEfrt3OJHCtqrd0ByH5nUS2h/KU4n8HeBU/DkOxWn/b/hoH6kIGgP3wr1DUi/GvJuIaN34EGbqKh9QeGNvFb0njbdtrPpHVCz3GcZ8DL55u03XkDX9/zXZ2MFpNLdYH8LsIW+sOOvg9Kzv69RTTbGIqYdA7kHfPUoC5AfUCKnmKBt1HGDAXUkQCmoo8GeoJn2DuSq0kuvl73uytZZzYoYmj6jrABA6hbeLdca14c+HaWShnvtJWbqiif3+jvwVtVNi7tXR2jmM+9+sVZ+D9Jzcbyuqr+sbhsiHaOj2LRWAD1pWU05E3IqLYywDlLFw+/UpvxAz0dDjRQPWOJGYxqvOFgFIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgoLEDknPVnJ+ofP0aO6D8V96PprEDkvOhH3acydtJoweUxXBVx6AaP6CuU+U7avSA9pc/PequjaMHlJx/4Z/KOrDGDkhOh+4407mbxg4oVrOhj1hNjx3Q0UVAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQED/BwnIC8DJcXyhAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
</div>
<div id="hw2-2022-09-23" class="section level1">
<h1>hw2-2022-09-23</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Question about fast sorting algorithm and exercises 5.6, 5.7(pages
149-151, Statistical Computing with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="question-about-fast-sorting-algorithm" class="section level3">
<h3>Question about fast sorting algorithm</h3>
<div id="apply-the-fast-sorting-algorithm-to-randomly-permuted-numbers-of-1n." class="section level4">
<h4>apply the fast sorting algorithm to randomly permuted numbers of
1~n.</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to implement the fast sorting algorithm</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># list without the first number</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))} <span class="co"># iteration</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i])</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quick_sort</span>(test) <span class="co"># execute but don&#39;t return the sorted list</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="calculate-computation-time-averaged-over-100-simulations." class="section level4">
<h4>Calculate computation time averaged over 100 simulations.</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tt<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    tt[i,j]<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(tt)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># values of a as n varies</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(n,a)</span></code></pre></div>
<pre><code>##       [,1]     [,2]     [,3]     [,4]      [,5]
## n 1.00e+04 2.00e+04 4.00e+04 6.00e+04 8.000e+04
## a 1.76e-02 3.71e-02 8.17e-02 1.19e-01 1.697e-01</code></pre>
</div>
<div id="regress-and-plot." class="section level4">
<h4>Regress and plot.</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="fu">lm</span>(a<span class="sc">~</span>t)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,a,<span class="at">main=</span><span class="st">&#39;Regression&#39;</span>,<span class="at">xlab=</span><span class="fu">TeX</span>(<span class="st">&#39;$t=nlog(n)$&#39;</span>),<span class="at">ylab=</span><span class="fu">TeX</span>(<span class="st">&#39;$a_n$&#39;</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t,<span class="fu">fitted</span>(model1),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-3" class="section level3">
<h3>5.6</h3>
<p><span class="math inline">\(\quad\quad\)</span><span class="math inline">\(\theta=E[e^U],\quad U\sim U(0,1),\)</span> <span class="math display">\[
\begin{aligned}
     \therefore Cov({\rm e}^U,{\rm e}^{1-U})&amp;=E\big[{\rm e}^U{\rm
e}^{1-U}\big]-E\big[{\rm e}^U\big]E\big[\rm e^{1-U}\big]\\
                                          &amp;={\rm
e}-\big(\int_0^1{{\rm e}^u}du\big)^2\\
                                          &amp;={\rm e}-({\rm e}-1)^2\\
                                          &amp;=-{\rm e}^2+3{\rm e}-1\\
                                          &amp;\approx-0.2356806
\end{aligned}
\]</span> <span class="math display">\[
\begin{aligned}
     Var({\rm e}^U+{\rm e}^{1-U})&amp;=E\big[\big({\rm e}^U+{\rm
e}^{1-U}\big)^2\big]-\big(E\big[{\rm e}^U+{\rm e}^{1-U}\big]\big)^2\\
                                          &amp;=2E\big[{\rm
e}^{2U}\big]+2{\rm e}-4\big(E\big[{\rm e}^U\big]\big)^2\\
                                          &amp;={\rm e}^2-1+2{\rm
e}-4({\rm e}-1)^2\\
                                          &amp;=-3{\rm e}^2+10{\rm
e}-5\\
                                          &amp;\approx0.01564999
\end{aligned}
\]</span> * Using antithetic variable: <span class="math inline">\(\hat{\theta}_{AV}=\frac{{\rm e}^U+{\rm
e}^{U&#39;}}2=\frac{{\rm e}^U+{\rm e}^{1-U}}2\)</span></p>
<p><span class="math display">\[Var(\hat{\theta}_{AV})=Var\big(\frac{{\rm
e}^U+{\rm e}^{1-U}}2\big)=\frac14Var\big({\rm e}^U+{\rm
e}^{1-U}\big)\approx0.003912497\]</span></p>
<ul>
<li>Using the simple MC: <span class="math inline">\(\hat{\theta}_{MC}=\frac{{\rm e}^{U_1}+{\rm
e}^{U_2}}2\)</span>, where <span class="math inline">\(U_1,U_2\)</span>
are independent,</li>
</ul>
<p><span class="math display">\[Var(\hat{\theta}_{MC})=Var\big(\frac{{\rm
e}^{U_1}+{\rm e}^{U_2}}2\big)=\frac{Var({\rm e}^U)}2=\frac{E[{\rm
e}^{2U}]-\big(E[{\rm e}^U]\big)^2}2=\frac{\frac{{\rm e}^2-1}2-({\rm
e}-1)^2}2\approx0.1210178\]</span></p>
<p><span class="math inline">\(\therefore\)</span>Compared with simple
MC, variance of <span class="math inline">\(\hat{\theta}\)</span> using
antithetic variates can be reduced <span class="math inline">\(100\%\times
(1-0.003912497/0.1210178)=96.77\%\)</span>.</p>
</div>
<div id="section-4" class="section level3">
<h3>5.7</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate N simulations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<ul>
<li>Using antithetic variable:<span class="math inline">\(\because
\hat{\theta}_{AV}=\frac1{N/2}\sum\limits_{j=1}^{N/2}\frac{{\rm
e}^{U_j}+{\rm e}^{1-U_j}}2=\frac1N\sum\limits_{j=1}^{N/2}\big({\rm
e}^{U_j}+{\rm e}^{1-U_j}\big)\)</span>,</li>
</ul>
<p><span class="math inline">\(\quad\quad\)</span>let <span class="math inline">\(g(U)={\rm e}^{U}+{\rm e}^{1-U}\)</span>,</p>
<p><span class="math display">\[Var(\hat{\theta}_{AV})=\frac1{2N}Var(g(U_j))=\frac1{2N(N/2-1)}\sum\limits_{i=1}^{N/2}\big(g(U_j)-\overline{g(U)}\big)^2=\frac1{N(N-2)}\sum\limits_{i=1}^{N/2}\big(g(U_j)-\overline{g(U)}\big)^2\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by the antithetic variate approach:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>v1<span class="ot">&lt;-</span><span class="fu">var</span>(<span class="fu">exp</span>(u)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>N) <span class="co"># variance of estimate using antithetic variable</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>v1</span></code></pre></div>
<pre><code>## [1] 7.793404e-07</code></pre>
<ul>
<li>Using the simple MC: <span class="math inline">\(\hat{\theta}_{MC}=\frac1N\sum\limits_{i=1}^N {\rm
e}^{U_i}\)</span></li>
</ul>
<p><span class="math display">\[Var(\hat{\theta}_{MC})=\frac1NVar({\rm
e}^{U_i})=\frac1{N(N-1)}\sum\limits_{i=1}^{N}\big({\rm
e}^{U_i}-\overline{{\rm e}^U}\big)^2\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by the simple Monte Carlo method:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(u,<span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>v2<span class="ot">&lt;-</span><span class="fu">var</span>(<span class="fu">exp</span>(u))<span class="sc">/</span>N <span class="co"># variance of estimate using simple MC</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>v2</span></code></pre></div>
<pre><code>## [1] 2.395061e-05</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>per<span class="ot">&lt;-</span><span class="fu">percent</span>((v2<span class="sc">-</span>v1)<span class="sc">/</span>v2,<span class="at">accuracy =</span> <span class="fl">0.01</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>per</span></code></pre></div>
<pre><code>## [1] &quot;96.75%&quot;</code></pre>
<p><span class="math inline">\(\therefore\)</span>Compared with simple
MC, variance of <span class="math inline">\(\hat{\theta}\)</span> using
antithetic variates can be reduced 96.75%.</p>
<p>Compared with the theoretical value from Exercise 5.6 the empirical
result is almost equal.</p>
</div>
</div>
</div>
<div id="hw3-2022-09-16" class="section level1">
<h1>hw3-2022-09-16</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.13, 5.15(pages 149-151, Statistical Computing with
R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-5" class="section level3">
<h3>5.13</h3>
<p><span class="math inline">\(\quad\quad\)</span>Due to unbounded
interval, we canât use the simple Monte Carlo by comparison. The
following two functions are selected. The first one follows Gamma
distribution,<span class="math inline">\(\beta=1,\alpha=3\)</span>,
whose density is</p>
<p><span class="math display">\[f_1(x)=f(x,\beta,\alpha)=f(x,1,3)=\frac1{\Gamma(3)}x^2e^{-x}=\frac12x^2e^{-x},\quad
x&gt;0,\]</span> The second one follow the exponential distribution but
move right by one unit, so that its definitional domain is <span class="math inline">\((1,\infty)\)</span>. The second density is <span class="math display">\[f_2(x)=e^{-(x-1)},\quad x&gt;1.\]</span> We can
make them clear by plotting these densities and ratios for comparison
with <span class="math inline">\(g(x)\)</span> in the graph below:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>f0<span class="ot">&lt;-</span>g</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Probability density function&quot;</span>, <span class="at">ylab =</span> <span class="fu">TeX</span>(<span class="st">&#39;$f_i(x)&#39;</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;pink&#39;</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">TeX</span>(<span class="fu">c</span>(<span class="st">&#39;$f_0=g$&#39;</span>,<span class="st">&#39;$f_1$&#39;</span>, <span class="st">&#39;$f_2$&#39;</span>)),<span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;pink&#39;</span>,<span class="st">&#39;blue&#39;</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f0, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(g<span class="sc">/</span>f_i), <span class="at">ylab=</span> <span class="fu">expression</span>(g<span class="sc">/</span>f_i),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;pink&#39;</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">TeX</span>(<span class="fu">c</span>(<span class="st">&#39;$g/f_0=1$&#39;</span>,<span class="st">&#39;$g/f_1$&#39;</span>, <span class="st">&#39;$g/f_2$&#39;</span>)),<span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;pink&#39;</span>,<span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we simulate them to estimate the integration:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>) <span class="co"># to save the values of estimate and standard error</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(M,<span class="at">shape =</span> <span class="dv">3</span>) <span class="co"># using f1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">which</span>(x<span class="sc">&lt;</span><span class="dv">1</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x[i]<span class="ot">&lt;-</span><span class="dv">1</span>  <span class="co">#to catch overflow errors in g(x)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="at">shape =</span> <span class="dv">3</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rexp</span>(M,<span class="dv">1</span>) <span class="co"># using f2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>x<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4019936 0.3994158
## se        0.4560905 0.1578672</code></pre>
<p>As we can be expected, the second importance function produce smaller
variance.</p>
<p><font color="Green"><strong><em>Explanation:</em></strong></font></p>
<p><span class="math inline">\(\quad\)</span> The <span class="math inline">\(\Gamma(\alpha,\beta)=\Gamma(3,1)\)</span> density
<span class="math inline">\(f_1\)</span> is supported on the entire
positive line, while the integrand <span class="math inline">\(g(x)\)</span> is evaluted on <span class="math inline">\((1,\infty)\)</span>. There are a few values
between 0 and 1 (about 8.03% (=pgamma(1, shape = 3))) produced,
resulting in a bigger variance although weâve set them as 1.</p>
</div>
<div id="section-6" class="section level3">
<h3>5.15</h3>
<p>We need to estimate <span class="math inline">\(\theta =
\int_0^1\frac{e^{-x}}{1+x^2}dx\)</span>.</p>
<p>The best results in Example 5.13 is obtained by the importance
function <span class="math display">\[f_3(x)=e^{-x}/(1-e^{-1}),\quad
0&lt;x&lt;1,\]</span> corresponding codes are in below:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># f3, inverse transform method</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>theta.im <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>se.im <span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span></code></pre></div>
<p>In this way <span class="math inline">\(\hat{\theta}_1=\)</span>
0.5243 with <span class="math inline">\(se(\hat{\theta}_1)=\)</span>
0.0964.</p>
<p>Then we cut the interval as 5-folds: <span class="math inline">\(\left(F^{-1}((j-1)/5),F^{-1}(j/5)\right),j=1,\dots,5\)</span>.
On the <span class="math inline">\(j^{th}\)</span> subinterval variables
are generated from the density</p>
<p><span class="math display">\[\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right),\]</span></p>
<p>where <span class="math inline">\(F^{-1}(t)=-\log\left(1-(1-e^{-1})t\right)\)</span>.</p>
<p>Consider <span class="math inline">\(U_j\sim U[\frac
{j-1}{5},\frac{j}{5}],j=1,\dots,5\)</span> and <span class="math inline">\(\int_0^X\frac{e^{-t}}{1-e^{-1}}dt=U_j\)</span>.
Then we know X have the density <span class="math inline">\(\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right).\)</span></p>
<p>Now let we use transformation method to implement stratified
importance sampling.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>m<span class="sc">/</span>k</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>theta_s <span class="ot">&lt;-</span> var_s <span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>,i<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>k<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  theta_s[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  var_s[i]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <span class="math inline">\(\hat{\theta}\)</span> is</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta_s)</span></code></pre></div>
<pre><code>## [1] 0.5248247</code></pre>
<p>And <span class="math inline">\(se(\hat{\theta})\)</span> is</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(var_s))</span></code></pre></div>
<pre><code>## [1] 0.009351944</code></pre>
<p>which is less than one-tenth of simple importance sampling method
(<span class="math inline">\(se(\hat{\theta}_1)=\)</span> 0.0964).</p>
</div>
</div>
</div>
<div id="hw4-2022-10-09" class="section level1">
<h1>hw4-2022-10-09</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.4, 6.8(pages 180-181, Statistical Computing with R) and
discussion.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>6.4</h3>
<p><span class="math inline">\(\quad\)</span>If <span class="math inline">\(X\)</span> follows lognormal distribution, <span class="math inline">\(lnX\sim N(\mu,\sigma^2)\)</span>, so pdf of <span class="math inline">\(X\)</span> is <span class="math display">\[
f(x,\mu,\sigma)=
    \begin{cases}
       \frac1{x\sqrt{2\pi}\sigma}\exp{-\frac1{2\sigma^2}(lnx-\mu)^2}
&amp; &amp; x&gt;0\\
       0 &amp; &amp; x\leq 0
    \end{cases}
\]</span> <span class="math inline">\(\quad\)</span>Let <span class="math inline">\(Y=lnX, Y_i=lnX_i,i=1,2,...,n\)</span>, thus <span class="math display">\[Y\sim N(\mu,\sigma^2)\quad and \quad
{\mu}=\overline{Y}=\frac1n\sum\limits_{i=1}^nY_i\]</span></p>
<p><span class="math inline">\(\quad\)</span>Set <span class="math inline">\(S^2\)</span> as the variance of sample <span class="math inline">\(Y_i, i=1,.. ,n\)</span>, then</p>
<p><span class="math inline">\(\quad\because
\frac{\sqrt{n}(\hat{\mu}-\mu)}{S}\sim t_{n-1},\)</span></p>
<p><span class="math inline">\(\quad\therefore100(1-\alpha)\%\)</span>
confidence inteval is given by <span class="math inline">\(\quad(\hat{\mu}\pm\frac{S}{\sqrt{n}}t_{n-1}(\alpha/2))\)</span>,
where <span class="math inline">\(\alpha=0.05\)</span></p>
<p><span class="math inline">\(\quad\therefore
P(-t_{n-1}(\alpha/2)&lt;\frac{\sqrt{n}(\hat{\mu}-\mu)}{S}&lt;t_{n-1}(\alpha/2))=0.95\)</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span>.<span class="dv">05</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>calcCI<span class="ot">&lt;-</span><span class="cf">function</span>(mu,sigma,m,n){ <span class="co"># calculate confidence interval</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rlnorm</span>(n,mu,sigma)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">log</span>(x)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    v<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(y)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    UCL<span class="ot">&lt;-</span><span class="fu">mean</span>(y)<span class="sc">+</span>v <span class="co"># upper confidence limit</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    LCL<span class="ot">&lt;-</span><span class="fu">mean</span>(y)<span class="sc">-</span>v <span class="co"># lower confidence limit</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(LCL,UCL))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set mu=1,sigma=1,n=20</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>LCL<span class="ot">&lt;-</span><span class="fu">calcCI</span>(<span class="dv">1</span>,<span class="dv">1</span>,m,<span class="dv">20</span>)[<span class="dv">1</span>,]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span><span class="fu">calcCI</span>(<span class="dv">1</span>,<span class="dv">1</span>,m,<span class="dv">20</span>)[<span class="dv">2</span>,]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LCL<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">&amp;</span><span class="dv">1</span><span class="sc">&lt;</span>UCL)</span></code></pre></div>
<pre><code>## [1] 9523</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(LCL<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">&amp;</span><span class="dv">1</span><span class="sc">&lt;</span>UCL)</span></code></pre></div>
<pre><code>## [1] 0.9523</code></pre>
<p><span class="math inline">\(\quad\)</span>The result is that 9523
intervals satisfied (<span class="math inline">\(\mu\in CI\)</span>), so
the empirical confidence level is 95.23% in this experiment.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-8" class="section level3">
<h3>6.8</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The functions of &quot;Count Five&quot; test is copied from the book</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> S2<span class="sc">/</span>S1</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(f<span class="sc">&gt;</span><span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)<span class="sc">||</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                           f<span class="sc">&lt;</span><span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)))</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we write functions to compute the empirical power of âCount
Fiveâ test and F test.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>power_count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count5test</span>(x, y)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>power_F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">F.test</span>(x, y, <span class="at">alpha =</span> <span class="fl">0.055</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we compute the powers of the two tests under different sample
sizes, that is <span class="math inline">\(n_1=n_2=20,100,1000\)</span>,
and we summarize the results in the table below.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  result1[i] <span class="ot">&lt;-</span> <span class="fu">power_count5test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  result2[i] <span class="ot">&lt;-</span> <span class="fu">power_F.test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">200</span>),<span class="st">&quot;count five test&quot;</span><span class="ot">=</span>result1,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;F test&quot;</span><span class="ot">=</span>result2))</span></code></pre></div>
<table style="width:47%;">
<colgroup>
<col width="9%" />
<col width="25%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">size</th>
<th align="center">count.five.test</th>
<th align="center">F.test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.3104</td>
<td align="center">0.4162</td>
</tr>
<tr class="even">
<td align="center">100</td>
<td align="center">0.8545</td>
<td align="center">0.9807</td>
</tr>
<tr class="odd">
<td align="center">200</td>
<td align="center">0.998</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>From the table we can see that the power of F test is higher than the
power of âCount Fiveâ test when the sample is normal distributed.</p>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="hw5-2022-10-14" class="section level1">
<h1>hw5-2022-10-14</h1>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># packages will be used</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span></code></pre></div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 7.4, 7.5, 7.A(pages 212-213, Statistical Computing with
R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-9" class="section level3">
<h3>7.4</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aircondit, <span class="at">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we can see the structure of the data set &#39;aircondit&#39;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>aircondit</span></code></pre></div>
<pre><code>##    hours
## 1      3
## 2      5
## 3      7
## 4     18
## 5     43
## 6     85
## 7     91
## 8     98
## 9    100
## 10   130
## 11   230
## 12   487</code></pre>
<p><span class="math inline">\(\quad\)</span>Due to the assumption that
the times between failures follow an exponential model <span class="math inline">\(Exp(\lambda)\)</span>, thus <span class="math display">\[
f(x,\lambda)=
    \begin{cases}
       \lambda e^{-\lambda x}&amp; &amp; x&gt;0\\
       0 &amp; &amp; x\leq 0
    \end{cases}
\]</span> We can deduct from the probability density function that <span class="math inline">\(EX=\frac1\lambda\)</span>, and the following is
the process of obtaining the MLE of <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math inline">\(\quad\)</span>Denote <span class="math inline">\(\textbf{X} = (X_1,...,X_n)\)</span> as a sample
from exponential distribution <span class="math inline">\(Exp(\lambda)\)</span>, so the likelihood function,
also the distribution of <span class="math inline">\(\textbf{X}\)</span>
is <span class="math display">\[L(\lambda,\textbf{x})=\lambda^n\rm{exp}\{-\lambda\sum\limits_{i=1}^nx_i\}\]</span>
Then the log-likelihood function is: <span class="math display">\[l(\lambda,\textbf{x})=n\rm{log}(\lambda)-\lambda\sum\limits_{i=1}^nx_i\]</span>
<span class="math display">\[\frac{\partial{l(\lambda,\textbf{x})}}{\partial{\lambda}}=\frac
n\lambda-\sum\limits_{i=1}^nx_i\]</span> Therefore the MLE of <span class="math inline">\(\lambda\)</span> is: <span class="math display">\[\hat{\lambda}^*=\frac1{\overline{X}}=\frac
n{\sum\limits_{i=1}^nx_i}\]</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the hazard rate lambda</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>hr<span class="ot">&lt;-</span><span class="cf">function</span>(dat,ind){</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(dat[ind,])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to estimate the bias and standard error of the estimate</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boot</span>(aircondit,<span class="at">statistic =</span> hr,<span class="at">R=</span><span class="fl">1e4</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = aircondit, statistic = hr, R = 10000)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001306428 0.004373309</code></pre>
</div>
<div id="section-10" class="section level3">
<h3>7.5</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the mean time 1/lambda</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>rhr<span class="ot">&lt;-</span><span class="cf">function</span>(dat,ind){ <span class="co"># reciprocal of hazard rate</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(dat[ind,])</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">=</span><span class="fu">boot</span>(aircondit,rhr,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to compute 95% bootstrap confidence intervals by the standard normal, basic, percentile, and BCa methods</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)) </span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.2, 182.3 )   ( 24.4, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.9, 191.7 )   ( 57.1, 226.5 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="a" class="section level3">
<h3>7.A</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,mu,sigma) <span class="co"># Sample from a normal population</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>U,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;The estimates of the coverage probabilities are below:</span><span class="sc">\n</span><span class="st"> norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;,basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;,perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span></code></pre></div>
<pre><code>## The estimates of the coverage probabilities are below:
##  norm = 0.9051 ,basic = 0.9027 ,perc = 0.902</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the proportion of times that the confidence intervals miss on the left or right</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>left<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>right<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>pt<span class="ot">&lt;-</span><span class="fu">cbind</span>(left,right)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(pt)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;normal&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;percentile&#39;</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>pt</span></code></pre></div>
<pre><code>##              left  right
## normal     0.0489 0.0460
## basic      0.0502 0.0471
## percentile 0.0508 0.0472</code></pre>
</div>
</div>
</div>
<div id="hw6-2022-10-21" class="section level1">
<h1>hw6-2022-10-21</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.8, 7.11, 8.2(pages 212-213, 242, Statistical Computing
with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level3">
<h3>7.8</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>bias_se.jack <span class="ot">&lt;-</span> <span class="cf">function</span>(scor){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Compute original theta.hat*</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  scor.cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(scor.cov)<span class="sc">$</span>values</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(ev)<span class="sc">/</span><span class="fu">sum</span>(ev)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Define function for each jackknife estimate*</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  jack.scor <span class="ot">&lt;-</span> <span class="cf">function</span>(scor,i){</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    d.scor <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    d.scor.cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(d.scor)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    d.ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(d.scor.cov)<span class="sc">$</span>values</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(d.ev)<span class="sc">/</span><span class="fu">sum</span>(d.ev)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Iteration*</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  theta.jack<span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n,jack.scor,<span class="at">scor=</span>scor)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Return list containing jackknife bias &amp; se*</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">bias.jack =</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat),</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.jack =</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">bias_se.jack</span>(scor))</span></code></pre></div>
<pre><code>## $bias.jack
## [1] 0.001069139
## 
## $se.jack
## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>bootstrap)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-12" class="section level3">
<h3>7.11</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>model.validation <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x,valid.num){</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Step 1:Define a function that computes the sum of error square for different model &amp; validation points(could be leave-k-out)*</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  validerror <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x,index,fun){</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*Delete validation points from sample*</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    y_d <span class="ot">&lt;-</span> y[<span class="sc">-</span>index]</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    x_d <span class="ot">&lt;-</span> x[<span class="sc">-</span>index]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*Choose model according to fun*</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;linear&quot;</span>){</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_d <span class="sc">~</span> x_d)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index]</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;quadratic&quot;</span>){</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_d <span class="sc">~</span> x_d <span class="sc">+</span> <span class="fu">I</span>(x_d<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> x[index]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;exponential&quot;</span>){</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_d) <span class="sc">~</span> x_d)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> <span class="fu">exp</span>(J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index])</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;log-log&quot;</span>){</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_d) <span class="sc">~</span> <span class="fu">log</span>(x_d))</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> <span class="fu">exp</span>(J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(x[index]))</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;Error!Invalid argument.&quot;</span>)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">sum</span>((y[index] <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Step 2:leave k out*</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Obtain all combinations of 2 from n*</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  valid.index <span class="ot">&lt;-</span> <span class="fu">combn</span>(num,valid.num)</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*The following sapply function uses dataframe instead of matrix*</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>  valid.index <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(valid.index)</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>  fun_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;log-log&quot;</span>)</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(name <span class="cf">in</span> fun_names){</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*For each column of dataframe apply validerror function resulting a vector*</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    er <span class="ot">&lt;-</span> <span class="fu">sapply</span>(valid.index,validerror,<span class="at">y=</span>y,<span class="at">x=</span>x,<span class="at">fun=</span>name)</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*For each name iteration,assign a different name to er*</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(name,<span class="st">&quot;.e&quot;</span>),er)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">linear validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(linear.e),</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">quadratic validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(quadratic.e),</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">exponential validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(exponential.e),</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">log-log validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">log-log.e</span><span class="st">`</span>)</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">model.validation</span>(y,x,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## $`linear validation error`
## [1] 39.14455
## 
## $`quadratic validation error`
## [1] 35.74037
## 
## $`exponential validation error`
## [1] 36.90983
## 
## $`log-log validation error`
## [1] 40.93436</code></pre>
<p>It shows that quadratic model has the least leave-two-out error in
consistent with leave-one-out validation.</p>
<p>For leave-one-out error and plots of each models,please refer to book
page 209 ~ page 211.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>DAAG,ironslag)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-13" class="section level3">
<h3>8.2</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>spcor.compare<span class="ot">&lt;-</span> <span class="cf">function</span>(z){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Function for each permutation statistic*</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  p.spcor <span class="ot">&lt;-</span> <span class="cf">function</span>(z,ix){</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> z[,<span class="dv">1</span>]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> z[ix,<span class="dv">2</span>]</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>,<span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>estimate)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Use boot to sample permutation statistics*</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> p.spcor,<span class="at">R=</span><span class="dv">10000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(obj<span class="sc">$</span>t0,obj<span class="sc">$</span>t)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*p-value of spearman&#39;s test using cor.test*</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalue =</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*p-value of spearman&#39;s test using permutation*</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.pvalue =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ts)<span class="sc">&gt;=</span><span class="fu">abs</span>(ts[<span class="dv">1</span>]))</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*Use built-in data iris*</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">1</span>]</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">3</span>]</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">spcor.compare</span>(z))</span></code></pre></div>
<pre><code>## $pvalue
## [1] 0.04985095
## 
## $p.pvalue
## [1] 0.05319468</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="hw7-2022-10-24" class="section level1">
<h1>hw7-2022-10-24</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercises 9.4, 9.7(pages 212-213, 242, Statistical Computing with
R)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-14" class="section level3">
<h3>9.4</h3>
<p>Implementation of a random walk Metropolis sampler for this problem
is as follows.</p>
<ul>
<li>Set <span class="math inline">\(g(\cdot\mid X)\)</span> to the
density of <span class="math inline">\(N(X,\sigma^2)\)</span>.</li>
<li>Generate or initialize <span class="math inline">\(X_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N(X_{t-1},\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(U\)</span> from <span class="math inline">\(U(0,1)\)</span>.</li>
<li>Compute accept probability <span class="math inline">\(\alpha(X_{t-1},Y)=\dfrac{f(Y)}{f(X_{t-1})}=\dfrac{\text{e}^{-|Y|}}{\text{e}^{-|X_{t-1}|}}=\text{e}^{|X_{t-1}|-|Y|}\)</span>.</li>
<li>If <span class="math inline">\(U\leq\alpha(X_{t-1},Y)\)</span>,
accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_t=Y\)</span>, otherwise set <span class="math inline">\(X_t=X_{t-1}\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>rl.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sigma: sd of proposal distribution N(xt,sigma^2)</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0: initial value</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># to calculate acceptance rate</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[t<span class="dv">-1</span>], sigma)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[t] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[t<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) { x[t] <span class="ot">&lt;-</span> y; k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { x[t] <span class="ot">&lt;-</span> x[t<span class="dv">-1</span>] }</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mc =</span> x, <span class="at">acc.prob =</span> k <span class="sc">/</span> N))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>acc.prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  rl <span class="ot">&lt;-</span> <span class="fu">rl.metropolis</span>(sigma[i], x0[i], N)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> rl<span class="sc">$</span>mc</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  acc.prob[i] <span class="ot">&lt;-</span> rl<span class="sc">$</span>acc.prob</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>acc.prob</span></code></pre></div>
<pre><code>## [1] 0.8326 0.7037 0.3358 0.0947</code></pre>
<p>As we can see, only the acceptance rate of second chain is much more
favorable. Next we draw the sample path for each chain.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X[i,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(X[i,]))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAMACAMAAACkX/C8AAAAe1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OpA6ZmY6kNtmAABmADpmAGZmOgBmOpBmtv+QOgCQOjqQOmaQttuQ2/+2ZgC2kDq2kJC225C22/+2///bkDrbkGbbtrbb25Db////tmb/25D//7b//9v///9R7zWgAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO3di3rbuHYFYEzaZM60TaY9yTmNe4nbxrHx/k9YySKAjfsGARAEsdY3E0skceEmfklWHFlIBFk4YvQEEGRkAABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6dQDEEgiDS4R6l+RfPnqL0B1DxfOEQD6DzFvAGBwAGBsAGBwAGBsAGBwAGBsAGBwAGBsAGBwAGBsAGBwAGBsAGBwAGBszgtgkcsGAMx0OgsAGJwTAKiZwnFXCQCumUan+frls/z1uxCfdgzh7i+ZEgA0GaPPuFOkzWm+fbut/z9+SPkcEAAAVd0CQNe0Oc3XP78/1v67AtU18+e9AKDzwACQSKNngL99ly8uAO4QANB5YABIpNFpvvz2/e3b1/eXQsVDAEDngQEgkVan+frl/mLnt+87hgCAzgMDQCInfBu0G4CqcwWAa2YBAMK7sScAcM0AQMORunQLAF0DANyR+lQKAAYHALgjAcAlMx6At7IAoPCIPj0AwEFDAEDtEX16AICDhjgUwP7TBYBrBgC4IwHAJQMA3JEA4JKZCoC/BwCajNFn3CkCAMwAwNETOCYAwEvmnzXs77fBEX16AICDhgCA2iP69AAABw3BASBiewCgyRihRgBw0BBupUOVHw1AAMDhEzgoAMAJABw/gYMCAJwAwPET6BgRuX3AcKHdbACBPQBg5fnjz8oeTKNQq93lO1cAoDSnB/D4J9n3fCj/WI7wsADQY7jQbgCoPOKeX7/fP4/Dfgbg/yK+0LAA0GO40G4AqDzikefbYz9eArEyFoA7oru0QsscABh5/fIJAFgBgNJMAUDKF3ESAJlLPjozABD+JgDoNkaoEQD0GC4wIgDUHtGlBwDoMlxgRACoPaJLDwDQZbjAiABQe0SXHmoBHLzIitJtbqw3IcoBiPEAcu+mA4B73FoASv4isiEAcW4ARZOrOKJLDwBQlIK/iHRHB4DaI7r0AACFYf9FJACUHQMAzdNnbty/iASAsmN6AgjsUZsAoDy8v4gEgLJjAKB5Dp5bRwCsH3QEgJI9FgD/EYc9IgDEhgCAsmMAoHkAoDQAUDYXu9It/3Uld3j2fgDgNE4CCK0Ue+DEuACwc4jwsYLTh3CXYOd4AIS1CwA4M6gJADgHAQA/ALBnLikAudXJHCJ8bBKAdWp7xtsZAAAAfh+J3d6uiwFQX04CgNYy+RMdj5WSWEsyMS4A8IdYCIC9nqoAkK7aAbB6AoBQJ4cAiJAAgPBwTQCo56cAgMRyAQBuHzUAhHXRou2vByB1EhaAkvcjSNcCAMrm0gBA+hk11DEABAfdA0DoPxwAwuwDgOSItNKjAbhdAgBrxu0ABHb580xPpioDAAgAiA4xAIAewH3HNTVjAACANokDEFEA9hzPAUBkAcQLDwB+H+HO+gEQ1qmlZ9E0JwEgBgDQfcwBgK75AADeP794NAaA6BAtAAhnR2LQcQDE4gDCCw4A3Mr0A2DWvb5hl3c/APsbGQEAznHHAbAXMwDQI84DIP7u0yAApuTuYmgGQFiX2X7CjE2Ljh/fZTYIdzEDAF24ABDtYQEA3ojXAWDe1nEBmIs2FoB90IkBOO83k4O7ALD63A+AdHwFAOThSG1MABBxAKIhANXoggDIKiwCIAYCsJf0dQEIWQWAXLQYAAtbGoCaTAkA2v2SALYr6gMQZm94Ws7WDABd4VkBqDVm/T1VAoB+/N4HQFAA1gOSP1mhJ7c2AOG0ZAIQvQBYT7DXASCSANT62w3ADOEA8B7gdJsiAKrjqwEQnQG4nXuTXQoAXSeiHoBe/HIfAMEHILIATF+c4uw6orCHBQDYFxcA2gIQpPIUgP1kdjCAt29C3D+g+9cfrM+nzwEQaQDxOXEA6GsQ7iA0xOkBFNWfABANAJgO6gDofTYA4QEQpvKnAfD06fb/x59tAZBpi+MBeDMTZnY2ALfNAABF9Q8CUCtcA9AVCwFwVvx2ox6AHrwdADpzP40AvP75/fbny4cf9AIIYS9E0uFW3BAAoZtmAQSmtgtAaEF6M6MPlacDwK2/Wq9MAPo80wDUIDYA3WYdAPLl4/8VPAMcDEBcHkC+/gcAECEA25oNASB1qgMg9KQTALxyNwLw/hR8yzPzd1QRAO7l2QlAb9oJwF2dcwHg1l+t1zAAvfb3AzC3DwEgTgPg7dt2BZYBIE4FgFn/gwGopRoGYBDoBTsvAG4P1gTPAUBYlWkHQEh7c1cAqYQBmDrlAIgeAFQN2wIQCQCC7ggVJ1++nWkOwCxSb5B2ANxl2gyA13PvVAJQD61dAKjaPHrLAxAxAGboiQBYy1SWABChjh9fhBC0Z11UAJAJAOqeBYCsPg4AvQgJAH01fACagJpiFABZ3PquDYAOrRAEALjPxZJT/+sAUCtdPd5J2psDwJ5YGQC1LKS72Z69X5xOqQOgjskCoKuQPhFL86cHQF3TBADS8w4A+iSmA6BLYNo5dWcBMEUFAHlSAGTBcgCYSccAmILPAkCYnQDQPC0A6GWkVq/UPe0BYPaEAdAVHgagh04BMCc3FQCzXjkATFupCtQfAJ1lAsC2Tk4FgCylJACzdigA0QCAcPdwAQgXgIgD0P3omZuxAEA9U5DejgEgQj33zggAdvfWdms9BwCQxS6dDrgAhJ4mmbkZ6/QAzLla7ciDwg4AoicAdQFjAPSGeQE4K5icCl3N5LBmAKz2Tm/CmWAIAGnnX4CBAMyUZwCgr4na6awlmQEgTgXAvCJRpaYA6NLKAgis8yoAdNFyALiHTAKAPkOlAAjS7lQATKcuAGdksk5OAMBalRwA3goU9vknAAhvhwPArAD1hCrd7d7wtQCEcwGGASAFag6A9kwfSgIAxNEA9MwCxemUMQBCd9oCCGZSAObBsRUAta7pw1EUgJBpAGTBqJ0eAD1dek7zAbCXm7e8zHnvBuD3KhQAd+d+AEFo5wFgnZzcBUA/as8CQFwFgLDOPw/A2V4JIBez7iMAtqP49R8OwCzULADnVGUQgMgAMIvWdE6uvB4GALaaRo8ON49s5wDgDDExAGuS0wDQ0+QDsJZkdXmzsQDQItMTsDfFVlAnALq7HSs+1E10sGsB0E31IM6p+n3KCABh+kkAMNOlpS4CYObRrLzZlAAIrRZ3EwDsvwAcAHqqzQHo5wQACACIrhZ3k3/+kaM5PZp9jQAkB5sRwHbPB2Ca6kGcUy0FYHolq1h9sab7uEFmygJg1krL8mbDABBMDkCkWSJZAHsbh45aEIB7qn4xZAyA6ABAPa2YCUwPwD6L4hwAIH38iQG4E44BMBt0061ju4OjAWgIYQDOubUsbzZ7AcSyY+UzWq4EwJ6fTAJQ96S3QTdVl5YFQI243dgBQK+b6QEEbnMyCYBUHyX1bwxAhAF4J5gFsLUlALxTTQFQd/MARAkAAQA7WwLANACsvgCgUctDAJjB+PVvDUCwAZBtaQDuN8DqAABwh/DPwit8Pp0A9Bs20FdB/XsBIJMJnWAZAL86KQCCCUCYoxMA1LZlAOwPABwLwL/njCVpQ9IPD4DTvQ1AdwoAvJEAYA8A0ROAKAagm54eQLxUowIAMrA1CoBUpQMAMR+Ap0fXn9P196bil+q0uQSA8GRCJ9gSgAyuWjK0uuMethsA6fQYAPffDvP+9VNx/QEgnZUAuK2LAERGOATA9gsy7N8RZk0iXn8ASOf0AELL/0wAQnNrWd57ggDi9Q+/Pjx5ACAEYNsZ2hg8IHHpZwagX/qol0Lp+g8EsH+woQBe/7rV9e3v/iMMqwfrAjiTCZ0gANDk6//86Jr3TTAAFNT/ccST+PT4EniE4fVAL4AzmfjW0wAItDn0GaBt/QGgoP7bEa9fxOfgr2DTV+g9O96G4wAQavUfBMDafwYA2fon0hNAtm3om7ZOQ5X0VVB/fcSLEF+jR1W8DccHEKnCEgAy9U/Fqb/3MAIAnPLdH4FexG/fwwfVvA13fgDhNpEL0vEZIF7/ZM4EIPJObJOhClqU1P/9iLdv6deghW/DWVPsBEAGD5gUQK7+yQCAv6eg/rx3gcrehrOmyARAz8m9gEEAMnRAQwCRdAHQ8l04BSAnmRUOAOvJeFIA+RS9DWdNMTxNAGiWawCQ8bUiIgvpUAD8C5Cdtznf8IkCQFX9eQDCrzVZh7kH7AIg3dsAQM4pDsBcVRnYGO4tPiIAWHekvy9bjcMAZH8i2J4Wv/7dAcSmmKhLHoA12NEA6AKZCYC36JzS7AIghwKINCipf18AzmOLvydUF+kuyTgA/Uf8Yc40Ce9PAgi2mQ1AYGEfCyDz2ioIwF8DcwIIrTF9vpG6OGz6AnC3sgFsU10EQHyltQUQGfBaAGS0UjkA5lpKAIjUvx+A0KlKe2nyAMjAXACAtrJq0AhAeDGHAaTbXACAPe2BAHS/1QAkOe2S+l8HgH/9AovZvvDe7gwAeQ0A0iq/LARgPXhnAIQvvwdArgHAOukSAN6eIgDhZUEa+qMBgN9Ed+sBkKb4PgD/qSMPINzGK3UAgOqgoP4DAcQMHADAOcbt5SIAtv/UfKU5BwuALADgfdObAUDe3DHdxwGYqwoAKQDkakuzdMOL+wAA5Cpvk2pY3tL6qznyAEgHgHMmdnUkBbAt2x0A6LWvB2DObiIAsgKAVCeoulLls5vpIpYDsNeHX28KQK+MuQFY6649AEn30eO3hVsBwJydPA8AcyUCAOT5ANCqlwEwK+NKAMyyB4DyC6AXRB0AUlR7T0cAkgXAnJOZjtNly/KW1r8dALrm1PKsBKBXeQ6A09F8AGRjAKaS5wYg1cVoVt7S+pNp7gEghV7kkpyYrnozANZqUANLdbsQgJnGSgDUCe8BoMdOAHCmyAVgV6S6vKX1V7UlF0HX3Vk2ar6mJQMAeX5oCEAaAOo/q5+5ATgMnCvjJQpAkhqqMVIAyDXZB8CaIQBYVzkBwFRNpgBIsxoMAHlVALpI5wFgrqwwPSQASLpTSDodOmzj8pbWPwVAF5YAsFoeAEBKC4AsBUA6F6ThfAACpOmSNSt2LwB9TehlB4CdAMiJmTXJAaBnUAlASj1/vXEeAGqhqn0MALr8SQC6qnkA5soGAEgDQJ8JFwAZoReAt2+Pf4/N+FSOIAC65BoA0BdGtgRATmh1ALIAgGQDUCWMAVAllGbadIphAOqKqmGdgjYCcP9UjvsnctQBUPMMAFClLgewzaEPAHuaEQC69TQA9P9JADILQI2vey0AoOczA4DH5zK9fPjRAoA050CmGwJATswaRwGQ9pZiAHpZRwCQeaqFTjo3V2tqAAEEps/mACTdKNUVMw9lpwYgXz7+X0cAtIF7YvY4HACqHLsB0FrHAegKnB2AecStBCCPB0AWi7nIhwJQH0xmfXwurRfZYk4jCECa7TYASRtUALCu6zaZDgD0AtNzNwCsieVyAAC1jwVAr/Otv1YAVLWCAOjj4CkBvH3bBAQ+P7oCgKRVVOuRA8AUSm0xV7ctAFLsGQCYVRACQO6o0/EB0GKwAKhrZhb39QCkYtWBA0Dq7aR1DIBZUjkAqpJJANLMrwEAZ+6LAJDCnTMFQK9EFMDWqACAtS7IPI8EoD+i2Dl7c6sHAH3VuACkC0CmAcgMAEkBSL0gAMCeggVAFgAwl0UmAejTOzUAssDODUBfNNU6BUA1k3MB2LYRAOaO9AHQFUTRWABoj9YUACAAQG1zAZBjPQCmdnrzMQDcc5oaAPVcCoB2vQOALAZAZrsXgAxO3y5Or1gLswqAvqWPbw9AD94AgH/e5wdA2gQAeGv7tACkPaI0LqLF6ZUwAHpzBwBJ/tgLgEyjAoCZKg+AvTyOB+CVaxwAvdhLAOjZlgFQwyWK0ytHAbBGFO6itQHI1gDI+Z0dAC3f+40aAPJgAGS2MwOgKxgA0jkDADkMAJmLO1sybwuA6i8IIFWcXikBYJ+odea0F/fQvQDMrMIAdNsgAH0yHACmoy4AuD+O2wOAqAYgSfUBYDu2JwB5OQDcH8etAxBa21wA6lA9jQgAGQRARrOPmg4AudUVQGgW1wXA/nHctQGEV1Pv8AC4UykBEDvC294MgDWKB0AOAsD4cdwUALrVB2Aul9s9AKSTBiAzAIL95QGEW3YGoI8d8xJIZn8ctxMA6QCIXhEuANOv11sNgMjDae9EFs9YAGpQadWpCIA5gwAA53HX3ZmdaskR9/B+HHc0ABkFQOfBBWCPL8jmqQDI0QAedyYHwOyhCIA8AIDcC8B64ekDMJ3OA8A5YiIA9qZxALI/jEUnfGIApF+vt6sC4DVTOzIAoi2PAuA8oU0MQPYGEJjHDgASAFgzAQDzZxEAWQnAHNsMAJ0qB0BkYgCw3akA4GwaByDfw2gAsgAAOdrrwJuqvkQAkJpJDoA1oaUBkOM5AGQpAAkAOQCp/gCgJJUA5NEA3KMDHdDjAOBUAPRGAAjOxRoFALZ7pwRARywB4O+bF4A+oC0Aq+fgPEJHO5uE/RUAGC3PAYDbA/eIgh76AgiNGOjL6ZnRKthBFsDjLgCQlk69VwXgTAoA+qYDALtfAGD3sA+APDUA+y4ApFo6ay8OwB1xB4Dw8TMC2A6aCAA9uXMCsHeMAWDvAYCGABJz6Q3Ae2w9EsDzx5+BrVMASL43kz8D7gRODyDaBwCk8vpF/duL9I+jR3YsA0ACwDUByF+/3z+SAM8A+SkAgHOvM4DwQaktO3P/p0jzApAAsASAQH+cQVl5/fLJBqBeFTGuMQAkW1QmDMBsYwKwvtq7AOA9L6LsGWDnJACgfMxUZ6yHHwDYn/kBZKfCDwC493YDcHfQr2MA5P9BUpNJAED5mKnOAKBVDgLgtQIAdg89AMgTAuD3CQChfQAQO+j8ADhbSw6oz4UBlAcA3HsAAAC5FvVjpjoDgM45D4DUkQCQ7mNSAPn+9jU7wxAAwB8z1dlIABIAGvQLAOweugGIdZ4eDACa9NseQL8AgDszAKjudzIAyfv5FlVjAkCjZmcYAgDKxwx2NhZA2TwAINAvAHB7CJ/kOADl8wCAQL8AwO0h3Bdr4aqvAHCaIQCgeMwLAIgeBQAlTQK7rgAg90/yAKBVszMMAQAmzE8lAIBWzc4wBACQ8D6V4MoAdgYA1K65AfA+lQAAend35BAAYIfxqQR9AXACAEP7vTQAxqcSNAAQ3AcAI4aYEoA3bIMj+D30AVD0HAwAI/u9OIDsv0mtXb4AcNIhuKmufvMAQGkvAFARAKgcAQDOOQQ3FweQ7QEAenc3aAhuAKB2hGoAO/ftGevI7l6/fJa/fhfiU78hWgQA2vWV31p65MQA3r7d1v8fP6R8DggAgEQAoLSXUwK4f/f1vvbfFXQZokkAoF1f+a2lR04M4O1v3+ULAOwIALSZwejuXn77/vbt6/tLIdM1+xdkHJYTTWULALSZwfDuHj+Q/lvofegTrboTTWULALSZwVm6GzQENyeayhYAaDODU3S3++PRD8uJprIFANrM4BTdAUB5ZgOQG6Hdkf166NYdAJQHAPqNNaK7QUNwc6KpbAGAfmON6G7QENycaCpbAGBwAGBsAGBwAGBsAGBwAGBsjgXQKwAweAhuTjSVLQAwOAAwNgAwOAAwNtcAMHHWAnC+AMDgAMDYAMDgAMDYAMDgAMDYAMDgAMDYAMDgAMDYAMDgAMDYAMDgAMDYHAIASaS6vKh/VfLla3kp0Gj/QA1y7qqctP4A0L4RAIxtBACDGwHA2EYAMLgRAIxtBACDGwHA2EYAMLgRAIxtBACDGwHA2EYAMLgRAIxtNAwAgkwXAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEunGYC3b+LDD96hv34X4qtuYX9JNfvDOzrX6LZffC5tdJve/TdSFzSKz6ygKpVB/ffVvxmAp0/3/zh5/fJVvtxOcWthf0mNcD+VskZPH3/++kvhSPfpPd+G4jd6/RKdGb8qtUH999W/FYD77/B8h5jPy8efN5lftxb2l1Szf7jtLmu0/WLRska/HsPwGz2Lf4nNrKAqlUH9d9a/FYBt2tzDb8y3FvaXeIu3v//X7ZCyRtu5lzW6rY37GuE3+t/3Y4PHF1alIqj/zvoPAvBccoaPFp+jpxlt8/LxP+6vdksv9Tdxe4wsaTQfANRfZQyA+2u8sqm+/jXuPNro5fYd2O3VbuFIXz7f53dpAKi/zhAAz/fv8sum+vQ1fprRRtur3fLn7cJKzgYA9TcZ8E3w++NP4bdGr1/eP+iu8Du3+77ib/e2opU0UnX2ji+pSl1Q/8HfBBe8DXd/Y4y0YL9h9X4mhW/D3Z6Ci95Rk/eXoJ8L34ZLzOyMb4Oi/jTNANweI5h/EfP0eDBRLewvibyfZlmj+1/EfC1ttP1FTEGj+Mz4VakN6r+v/vhRCGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBL53oAyEfC3z8I/+PPsdNZNsd8IFh1rgeAfBbSyzGfSYUE8vjQ/vPncgDop+E9fR48mXXz+ND+CXI5AOTzUN/+dsTH0iKhPD60f4LMDeB/bi/yhf06hwB4/fOf3j9kD+mbwFWQ+B7giLx8+G/5n/cy3z+DcrsIBMD9U2Bf/3WKyzBzQldBAsAReb69xv/1z/bbPM5Hwh/z6fxLJ3QVJAAckefbg837Qzx57HE+Eh4Auid0FSQAHJFff/n3+2+7sjeat0HvH00feGhC2iZ4FQDgkPz6N/GP7iP89pHw97dAn8VRn86/dEJXAQAQZIYAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWTj0AgSTS4BKh/hXJl6/+AlT3cOEcAaD/EPMGAAYHAMYGAAYHAMYGAAYHAMYGAAYHAMYGAAYHAMYGAAYHAMYGAAYHAMZmFABclC0AUJfakwOAwQGAugDA5AGAugDA5AGAugDA5AGAukwK4IgfgpwjAFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAJg8AFAXAOia/tMEgLoAQNcAwNkDAF0DAGcPABSmbGAAOHsAoDBClpwSAJw9AFAYALhWAKAwAHCtAEBhAOBaAYDCAMC1AgCFAYBrBQAKEwcQ2goAZ8/EAMZcFwC4VgCgMABwrQBAYQDgWgGAwgDAtQIAhQGAawUACgMA1xIBAIUBAAAoaw8AXQMAdQGAwgAAAJS1B4CuAYC6AEBhAAAAytoDQNcAQF0AoDAAAABl7QGgawDgPbunBACFSQLosVQyXQDAe2YH8PrndylfhBCfeT30BxDrHQAAoKw9G8DLp9uN54AAANi/u0UAoKo9F8Dbt6+3G7/++GFaqgQ6BYB2IxTPoM+YVf/K75IAEj0AQMMRimcAACXteQC+fPjx/P4S6BOrhykB7JswALAa92jI6bTZu0CvX8Rv3+XTx5+sHo4EYI8TH7kBgB3vpALAo3GPhocCKOthFABxDgAivbtxAKDqmHkARFZrKQD7+Nid/Ax42wDg0bhHw9MDaHwhACCcawCIHAEAkXHGAsiscADwGu89AgAi46wFoOxv4gGgwcAFSQJoeDEWB8D/m/irAnAPAQBvcyMAsUlnAYj07t1h/k38dhMAGgxckGMBeGtsWQDRyQBAg4ELMhaA9bNILQBEOzDbRWyFdwPA/Jt4AGg2cEHYACo/NH1hANy/iT8NgPK1CgDMcSoBiHhJTw0gEQAo77awl+IeQgBEYwDqBgC4NwGgwcAF8Xp4vDPRHYBQg9FDhIgtYQCoHAYAuD3sBJCbyaM5ALipBcA8HADYPQBAZHefLAiAf55XBSBsAHpldgcgzEySXQR390kZAOciJM423ZA9p/yUUkesBSBz5dgAhFcruQ+AM6EUAPvpKTxCn1wJgNfuegDi41UCEHqMtgDs9aUBCLvV5AAY0+QDCKACADaA6P4aANt+Ye9yV68uawqAkACQn1AFAPtBaUEAsQP6ACCdEgB0VQNAsGF6Qm0BeGWdAYBoBMA8GhtVHQEIAOA1TE8IADQAs4BbAdiO8gCoFW7bawfA7DIATHenAZD9VsptDACVsVbUY300AOA+wrYC4CzuDAB6QSYF4K74ywIIjnFiAP4TxykACACIDAMAjB7e114eQLDmHgB68hkA6v8oAFEKQG8iE54BgLgOAP1QtAIA0R+AnpqZNheA0AcDQLT9wmkAABMRSURBVGhcb0d/AP4g5wIgXABCwVBN7IL6AMih24bdAMzYBoBZ07rM1wcgpFN2ADgKgIgAIOuHBUBQAPaKHQbAzBMASJ+sY60jhN10PgDkdQYFoBbWPgDqgjIAiCIAGsxuAPpbi+iVGgpA1c3d7zQ+EEBimFoArvvcJAuO4PewD4D5CgB70gCAvzEwzCgAwm89FQC1KMsAbOu1GoDQR5upqe5EGwDCOhunpgBAjwUAodfSHgBCAbDeZiL3hVq/XAACAACgNgwA+n8OgMeCHgfALPQkAHWy2rcpxWQARGBjYBgAyPYgzLJqCEAtriAAteR3AVD3OADEhQEIf2NgmCoAgjYJtawAsJXeXETOJAuO4PdQDUAtpZYA1GIlT06qOwJALQ099x0AhDm2YXmzYQMwZ+m0yAEILi0GALIydgMQ8wHQK6sUgDBLiQVAWI20PA2A7PYAWNP0AegxCwHYK7BJeQvqDwCnAqAWlAtArxshzXmQh2+6MgMArI7MBheAuyELILCd9EsBGFQnBWAtGKG/uABU/csBiNBR1iycfooAkIW9B4DV+1gA5rFaAzBLWy2jKAC9Bs2NIwHYzyxSWFOkT1IzAzBnEunR3M8AIGcNAHkAwgNg9hwMwCjgAdAzJxM23U8FgF6SSI/m/lgAwu5uGgDWcq8BQFZ9AwCBiVrL2p4nAJB+yAbnGANA3U4A8OpSDUAYAEX1PwaAvbh9AMI7Rl0XZwk7HQEAH4B6QDFH7wBAFvJZAKiVfwYAbnIARCUAsiENwG4XkRrc6gMg8wo/J50WgHrIUUcDAOsIfg/CDQeAEKGW9kIrAmCWKwDINAB6QuEezf1TAxAzAPAWlllgbQDQzbRPX2B4ogDg92junwCAGWFb9Xq4BQCE12l/ALr7FABzc2oAZOX5IwiyBo8FoBa7EGbPJAAi684BkAoLgDfKTgCRrQoA3RNoIMmxDctbUP+DAAj6ZGCOqQCgrtgqAMxKYQKw740A4A6QAiCKLkDD+h8CwKw16xAAkAcA8LYlAHAnktgl4zsBoBgAWbL7AaiOAcC92REAc9dZAOjxAwCMDmlfLqunIQBEIwDidADSq6gVAOeIJgASuRwAQXoCgKLUAdhxCAdA+5nwGpwVAJlf8HIFAVhfNQA1AD01cRiAbWgXgJ6UmAkAI7MB2PY2LG9B/ZsDoB2VAHBeUoUB0HnvAaBnBwCsVsXDVDRoWd6C+ncGIE4HwEIp1OkDwPIA6PrrBYCeZQkAIeMABBeAAID47lbD1HTXsLwF9b8MAKH78QEINcIJAfQQEEgHAI3TsrxF9acA1CrsDMB0T/t1ZpYCoLvVAPTMhQCAdACAA4CUiQ3AXeOPXskJxgCQChQC2IaIABA9Abz+9efj3tvff4QPe3qM8TnWAz35A3MRAPn6JxICYFao8ADotWfNmANAtAWgnlIiAOiMBQGgl3nLZ4An8enx5ePP4FFP2/anT7EevJIekosAyNY/lQ4A9GsOM4Jubbonq5ycNalABQByJmrcOAByDvpc/OKky/f6RXx+Fh8ijz+vf35/3Pj1hzkidLmPzlUAZOqfjFV/s2zmBCA4ANR27+VdBQApX4T4GjsoCCAwxv4lc62UXABO/ZNhACAzE2kA27oSPABaDTlrUgFhT2x7wNYa0gCsGduDqz89AOrAYHHS5bs/Ar2I375HjlIvfZ4CT9EnBjBqQiUXgFX/VLoAEEUA6FmT2z4A5yVOMYDkM4DZHyxOqnxv33KvQZ8fA5ztm+BMZgGQr38irQAI0QOAWalHANialtT//Yhm70KcLLMAaFd/+sq5DMC2FB0AQo1getU7dwIQaqgTAagKAPjjNixvWf0JAJkCYJYt2R4BIM4BQE/ABWBfZVlYfwDoMW7D8pbVfy+Axz4bgOgOYLup5iXIIADQIgBQCUCUArAqEADgDCV4AKzpWwD8F0EAQEJqmZobc94ycCtyZMPyltWfCUBEAJCFagNwzlsWA7DnYS1kAGCndAAAqACgTyUBQKQBiFCPZnpm1MsA6ExgFwCZApDEIWN31wCwVY8NQJAupRk7tJQtAHpewtng1/oCAPYQCReD0YACCLfdAUDaO2SgfcvyFtW/PQCrcA6Ax1666s13C2bsLAC5/VkGwNxbC0D0dZZ7mfXXQwGQy9+ovI9wfxrXmspjUxhAiG0cgNdEPa3aAIQHgDayn0qkdZX2A3BPBADI7csA2PPTuObB3l6jFQC88/Q2SheADF49DwC5H5md2eoB8IyU1B8AAgs4dGckAP5P4zpTKQRAT4cFwH6GCQCQewGEAwCxS9EZAD3sLABC9d8PQF08UusaAHofADhnMAaALAZgXdnRAPg/jVsAwCmEBqBPUyaapAGYh5wIAGtWDoBUAGBRAOyfxmUDkO53DDEAZjF7dUsBkP5Tx2IAvFkFJstMHAC55HsBWKtGWsUtACCtJi3LW1T/LAB9kjIOwF6QWQBWzWQAAH3dkwMQXjWRLWcHYJ2tCE2Wmb0AzKt/5/06a5b0WgcBqEGuAkBN0a2VB8CctXSr6wJQh8oEALsfC4C+CP5aFu4W75KfDYAurAMg/FASTlA6E4B0KpMCIMMAJLmqdG24Y5o5nQyAnk4QgNQrNXSSUp2RASClc8bNAOijrwvAVNGfbOis/Du7AGzVl7UAzPrOA9B7Wpa3qP4uAHU2ToV2AaAF1h1ZANQW+xIIqceiz7A2ACmcxeOdhbPdnrpzSEn9TwHAKiFZiN6Vczqg1yUFQDIA0HFDAOi7IgsBkASA3UJv16V6zMW6TmEApGbk3oUBkGfJ6QFYD4b0AAAAgCwAaU+WXqBqAOp2HgC9glEAqg8HgL0W6AHnBEDpWmXzAOjTZAEgxSgCoC9RGwDSDEUOKan/EQCkVSMvZvmYK5YFIHV56VXVHeQAmAcPDcC87L0+AGmuhNQnbAOw/wgC2IYkF1fqSw0A5BFE0hoJLxYAWQzArOVqAGp6BQD04+XZAEh35j4AvZIDAMxDgpTOSasnzA4A/OvuLXmyhsIA5IkAqNI5FMjZ6IKeC8B2aem1CgGw1tmZAZilrs5BXS0HgG5YAoDclUkA6lYzAHqeZlmdHwBdh6agIQD+Q5c5fV2KEgBkefQCIHX7RuUtqr+eZXMAVvl6AtBPKASAJIdaD6L6TC4KgCz2CADyZMEBYNatu7bViZhLmQJAOjJXmCy5huXNJg7AbAsCMFutNd4QgOwAQNrduQDUlPzi5Mu3M1YPxQD0RSsAsNWWVLwHAOkfJOgJkd6tExwPwJ2YugAsAPoEWgHQM2MBoFMFAArAnD8AWMkBMBdgIgB0yQOAOUb3oC+O7tEUOQdAHynMjhwAdYHWAmD/wQQgywHo7tWszITNFcsCMGsmWJx8+XbGByAZAORJAaj6q34BIAKAnmwVAHUWFwcgmwBQDxZZAGpFegDUlBIAzA3pHJQFsN1sWd5shHW7IwB9hdR6VLc4APQDiwOAVl1j2A9ANw8UJ1++fdkFQJUpC4AeKMzp5gHYS7Q9ABkFQCsCAHsBmIs0FQDy8JsCoM5PXy+15g0Avc44ANQVcQEoBlJPAQB2AlDHRwHQCZGKm20ZAGblWmMUAKBTChQnX7592QtArav2AGg5ydW2AZhVEgMgpTnCA7AdGQQQLU6XCPe2C0BWALBHUJe1EQByKADkAJAl1hqA3uqfEQBYt2wAUt0CAHqvBQB5OADrROwC8gDQm9HidEkTAFI3lGUAtu3WquMBIJMz3ZCvlwCg5yP0ue4BoC9hHoDeT/6oAGAPNzEAtYSOBGCXlA+ATjgMQM4EQEYBmAYAsD8BAHQ2HgBakmkBSBeAOpx24xQnnOYA9MlGAKhKhADQs4gDUKNYV94GYCbWCgAdcwIAptwpADICwOk3C0Daqy4JwOKyKAB6CUYBsJbvbgDWWU0AQE4GQM4LwFlPANAteQCPrzEA1ku6QwDIEgCSCYDO0p9IPOcAoBrR63EgAMYZAYCsBUAvnnD2e0dfDYC9VKzFkgNgXywySiEA0qoUgDOmXeBkuQFA3ygFYJZFGIB9lNc6NEAofQBYC8MHYDUzRQeAPTkJgOC9nQDM3WsBCA8JAHXhApDTA5A2AOuoswHwJ5QBsN0SgVOjF4t2kQNgdaLnVgPAP/wKAGj9mQCkV7kCADIGIHBiAGCO7wOAdUbhMeOHprY0T1sApgkAMNMUgASA0gDAHACiQ7IBuJekEoAEAADoAsC9dRgAGQFAblsrfykAj9sZAPRrDkB8FgEA0r5+4VaBnTYAuSYA77gKAOZoOlIy0e78+wAQ7EkPnpx7cOfMAKKbAKBpzgEgPicyOOs4aycF8JhBqOWZADAO6AJAGgD5ibjVTGZVAIERjgWwHbA2gOBxcQDMiQAAAPCPqO4hWywuAOc2AHhDHAagYE5kcNZx7gH0JwBGAXj987uULyL7m8p3JgIgMU4QAHuchQFIACidwj13AC+fbjeeAwIAIDGLqQCEerTu8woW6OGxbWoAb9++3m78+uPHvh5Yc6gAUDRO9KEuO+7VAATeNkuNMAYAPRAAyO39A7cDkDiUP0Jd5gHA2+YeYAMItuwP4MuHH8/vL4E+kZYqnB5YczgcQPnBAFA8p9Jt7gGMa90dwJ2A+O27fPr4c3cPjDkAwJ7UA2CPsDCAQ3oAgD3pD8C0XxvA+5uhVT1k5gAAewIAFwLw/iejw0oARZkcgHOo+jEoteWgIspKACVdLwPgoFwawKGV9DMXgO49AMCeAMBlAGz3AKAoAAAAXTMngNhs3OoCQL77g3s48PsyVgCgXwAg0AMAlKUMgLsVAPLdH9wDAJTl6gCKuwGAtgGAfgGAQA8AUJZCAPlNBwYAAj0AgBf2v8gT7obsbC4BIN4GAOpTACDTeHfY/yIPACQAdM0wALx/kAQAEgC6BgCaBgACPQCAF/a/yJsNQDZrAHD6O/k1KUqrc2H+izwAkABwqox8GzR9aHzTmQIAk6fluTD+PUY5gJMHACYPANQFACYPANQFACbP6b8HOHkAYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIAQF0AYPIcDCAz5nyVBYDJAwDHBwBOFAA4PgBwogDA8QGAE2UEgNUDACcKABwfADhRAOD4AMCJAgDHBwBOFAA4PgBwogDA8ZkdwKWuKAAcHwA4UQDg+EwP4EoBgLEBgMEBgLEBgMEBgLEBgMEBgLEBgMEBgLEBgMEBgLEBgMEBgLEBgMEBgLE5BACSSHV5Uf+q5MvX8lKg0f6BGuTcVTlp/QGgfSMAGNsIAAY3AoCxjQBgcCMAGNsIAAY3AoCxjQBgcCMAGNsIAAY3AoCxjQBgcCMAGNtoGAAEmS4AgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlk4zAG/fxIcfvEN//S7EV93C/pJq9od3dK7Rbb/4XNroNr3fvhc1is+soCqVQf331b8ZgKdP9/84ef3yVb7cTnFrYX9JjXA/lbJGTx9//vpL4Uj36T3fhuI3ev0SnRm/KrVB/ffVvxWA1z+/PyDm8/Lx503m162F/SXV7B9uu8sa3febuTEb/XoMw2/0LP4lNrOCqlQG9d9Z/1YAtmlzD78x31rYX+It3v7+X7dDyhpt517W6LY27muE3+h/348NHl9YlYqg/jvrPwjAc8kZPlp8jp5mtM3Lx/+4v9otvdTfxO0xsqTRfABQf5UxAO6v8cqm+vrXuPNoo5fbd2C3V7uFI335fJ/fpQGg/jpDADzfv8svm+rT1/hpRhttr3bLn7cLKzkbANTfZMA3we+PP4XfGr1+ef+gu8Lv3O77ir/d24pW0kjV2Tu+pCp1Qf0HfxNc8Dbc/Y0x0oL9htX7mRS+DXd7Ci56R03eX4J+LnwbLjGzM74NivrTNANwe4xg/kXM0+PBRLWwvyTyfpplje5/EfO1tNH2FzEFjeIz41elNqj/vvrjRyGQpQMAyNIBAGTpAACydAAAWToAgCwdAECWDgAgSwcAkKUDAMjSAQBk6QAAsnQAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALJ3rAjjmA6mQUN5rv/1ygJPnugCeDvpAHsTL9oH9j18OcPJcFsD7x9kjI2I+sH+CXBXA4+PskRExH9g/Qa4A4H9+F0I4nwD5+Dh7pHdCtX98D7D9coCz5wIAXj78t/zP+2K/f9e1XY7t4+yRzgnVXm4AHr8cYOj0GLkAgOfPt4r/809r2/Zx9kjnhGov1TPA+y8HGDGrklwBwO1h5/Vff9BHIfVx9qOndvkEan+P+h4AAI7Ir7/8+/13Xnmb8QzQP6nab78c4OS5AAD569/EP/qvNQHgiCRqv/1ygJPnCgAQZHcAAFk6AIAsHQBAlg4AIEsHAJClAwDI0gEAZOkAALJ0AABZOgCALB0AQJYOACBLBwCQpQMAyNIBAGTpAACydAAAWToAgCwdAECWzv8D2HvYcm7yPhwAAAAASUVORK5CYII=" /><!-- --></p>
<p>Next we plot the histogram with the true density besides.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(X[i, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, fx, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plots above, we can draw to the same conclusion to the
previous part, that is, the second chain is more suitable. Next, we
compare the quantiles.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(z), z) <span class="co"># generate laplace random numbers</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(z, p)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> X[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>Qmc <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, p))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>QQ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qmc), <span class="dv">3</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(QQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>, <span class="st">&#39;sigma=0.5&#39;</span>, <span class="st">&#39;sigma=1&#39;</span>, <span class="st">&#39;sigma=4&#39;</span>, <span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(QQ)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=1</th>
<th align="right">sigma=4</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.020</td>
<td align="right">-2.206</td>
<td align="right">-2.131</td>
<td align="right">-2.451</td>
<td align="right">-2.165</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.235</td>
<td align="right">-1.687</td>
<td align="right">-1.522</td>
<td align="right">-1.747</td>
<td align="right">-1.655</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.853</td>
<td align="right">-1.024</td>
<td align="right">-0.891</td>
<td align="right">-0.975</td>
<td align="right">-0.938</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.538</td>
<td align="right">-0.608</td>
<td align="right">-0.493</td>
<td align="right">-0.525</td>
<td align="right">-0.535</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.167</td>
<td align="right">-0.323</td>
<td align="right">-0.218</td>
<td align="right">-0.222</td>
<td align="right">-0.251</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">-0.078</td>
<td align="right">0.012</td>
<td align="right">0.014</td>
<td align="right">-0.007</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.167</td>
<td align="right">0.123</td>
<td align="right">0.238</td>
<td align="right">0.250</td>
<td align="right">0.254</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.538</td>
<td align="right">0.393</td>
<td align="right">0.541</td>
<td align="right">0.484</td>
<td align="right">0.503</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.853</td>
<td align="right">0.770</td>
<td align="right">0.972</td>
<td align="right">0.880</td>
<td align="right">0.941</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.235</td>
<td align="right">1.424</td>
<td align="right">1.608</td>
<td align="right">1.574</td>
<td align="right">1.605</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.020</td>
<td align="right">1.998</td>
<td align="right">2.335</td>
<td align="right">2.194</td>
<td align="right">2.290</td>
</tr>
</tbody>
</table>
<p>As we can see, the quantiles of the second or third chain are close
to the true quantiles of standard Laplace distribution.</p>
<hr />
<p>Finally, we use the Gelman-Rubin method to monitor convergence of the
chain. Suppose we are interested in the mean, i.e.Â <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th chain.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
</div>
<div id="section-15" class="section level3">
<h3>9.7</h3>
<p>To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below and plot the generated sample
aftering discarding a suitable burn-in sample.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rbn.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, mu, N)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> XY<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; Y <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, Y, <span class="at">xlab =</span> <span class="fu">bquote</span>(X[t]), <span class="at">ylab =</span> <span class="fu">bquote</span>(Y[t]),</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">range</span>(Y))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">cbind</span>(X, Y))</span></code></pre></div>
<pre><code>##           X         Y
## X 0.9857700 0.8825708
## Y 0.8825708 0.9793533</code></pre>
<p>From the result above, we can conclude that the chain has converged
for the sample covariance matrix is close to the truth. Next, we use
different initial values to monitor the convergence of two chains
(i.e.Â <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>), with <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th cain, respectively. Notice that we
calculate the sample mean of <span class="math inline">\(X_tY_t\)</span>
for monitering the convergence of covariance.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> k)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>Xmc <span class="ot">&lt;-</span> Ymc <span class="ot">&lt;-</span> XYmc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, x0[,i], N)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  Xmc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>X; Ymc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  XYmc[i,] <span class="ot">&lt;-</span> Xmc[i,] <span class="sc">*</span> Ymc[i,]</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>cal_phi <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(phi)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>phiX <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Xmc)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>phiY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Ymc)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>phiXY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(XYmc)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>plot_erg_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(phi, rg) {</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> rg,</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiX, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiXY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>plot_R_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.25</span>))</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiX)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiY)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiXY)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
<p>Finally, we fit the simple linear regression model.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Y ~ X)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.64063 -0.29287  0.00232  0.29072  1.78491 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.002320   0.004592   0.505    0.613    
X           0.895311   0.004618 193.865   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.435 on 8998 degrees of freedom
Multiple R-squared:  0.8068,    Adjusted R-squared:  0.8068 
F-statistic: 3.758e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficients of the fitted model <span class="math inline">\(0.8953111\)</span> is close to the true value
<span class="math inline">\(0.9\)</span>. Then we check the residuals of
the model for normality and constant variance. Theoritically, the
variance of <span class="math inline">\(e\)</span> is <span class="math display">\[\textsf{Var}(e)=\textsf{Var}(Y-0.9X)=\textsf{Var}(Y)+0.9^2\textsf{Var}(X)-2\times0.9\textsf{Cov}(X,Y)=0.19.\]</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> lm.fit<span class="sc">$</span>residuals</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(e, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(qx, <span class="fu">dnorm</span>(qx, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(e)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(e, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw8-2022-11-04" class="section level1">
<h1>hw8-2022-11-04</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Two class work.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="mediating-effects" class="section level3">
<h3>Mediating effects</h3>
<p>Testing the mediating effects. Consider the models <span class="math display">\[M=a_M+\alpha X+e_M,\]</span> <span class="math display">\[Y=a_Y+\beta M+\gamma X+e_Y,\]</span> <span class="math display">\[e_M,e_Y \sim N(0,1).\]</span> And <span class="math inline">\(e_M,e_Y\)</span> are independent.</p>
<p>The hypothesis testing is <span class="math display">\[H_0:\alpha\beta=0\quad
H_1:\alpha\beta\neq0.\]</span></p>
<p>The test statistics is <span class="math display">\[T=\frac{\hat{\alpha}\hat{\beta}}{\hat{se}(\hat{\alpha}\hat{\beta})}=\frac{\hat{\alpha}\hat{\beta}}{\sqrt{\hat{\alpha}^2\hat{s}_\beta^2+\hat{\beta}^2\hat{s}_\alpha^2}}\]</span>
while <span class="math inline">\(s_\alpha\)</span> and <span class="math inline">\(s_\beta\)</span> are the standard deviations of
<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> respectively.</p>
<p>We can implement the permutation test under the following
conditions:</p>
<ul>
<li>Condition <span class="math inline">\(1\)</span>: <span class="math inline">\(\alpha=0,\beta\neq0\)</span>. In this situation,
<span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> are independent, which means that any
permutation of <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> are independent;</li>
<li>Condition <span class="math inline">\(2\)</span>: <span class="math inline">\(\beta=0,\alpha\neq0\)</span>. In this situation,
<span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent, which means that any
permutation of <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent;</li>
<li>Condition <span class="math inline">\(3\)</span>: <span class="math inline">\(\alpha=0,\beta=0\)</span>. In this situation,
<ul>
<li><span class="math inline">\(M\)</span> and <span class="math inline">\(X\)</span> are independent;</li>
<li><span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent.</li>
</ul></li>
</ul>
<p>Set the real values are</p>
<ul>
<li><span class="math inline">\(\alpha=0,\beta=0,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
<li><span class="math inline">\(\alpha=0,\beta=1,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
<li><span class="math inline">\(\alpha=1,\beta=0,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
</ul>
<p>Then implement permutation test for each situation of parameter under
the three conditions above.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function to generate the random sample</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>RSample <span class="ot">&lt;-</span> <span class="cf">function</span>(n,alpha,beta){</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> <span class="dv">1</span>;aM <span class="ot">&lt;-</span> <span class="fl">0.5</span>;aY <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> aM<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> aY<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>gamma<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(X,M,Y))</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The function of test statistics computation</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>Ttest <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M,Y){</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(M<span class="sc">~</span>X))</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M))</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  sea <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  seb <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>b<span class="sc">/</span>((a<span class="sc">*</span>seb)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(b<span class="sc">*</span>sea)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co"># The function to implement the test hypothesis</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>Imptest <span class="ot">&lt;-</span> <span class="cf">function</span>(N,n,X,M,Y,T0){</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> T3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 1</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[n1];M1 <span class="ot">&lt;-</span> M[n2];Y1 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    T1[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X1,M1,Y1)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 2</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> X[n1];M2 <span class="ot">&lt;-</span> M[n1];Y2 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    T2[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X2,M2,Y2)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 3</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    M3 <span class="ot">&lt;-</span> M[n1];X3 <span class="ot">&lt;-</span> X[n2];Y3 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>    T3[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X3,M3,Y3)</span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition1</span></span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T1))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition2</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T2))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition3</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T3))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(p1,p2,p3))</span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># The number of simulation</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># The number of random sample</span></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>T0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a><span class="co"># The real values of parameters</span></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>);beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">RSample</span>(n,alpha[i],beta[i])</span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> result[[<span class="dv">1</span>]]</span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> result[[<span class="dv">2</span>]]</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> result[[<span class="dv">3</span>]]</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The original value of test statistics</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a>  T0[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X,M,Y)</span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>  p[i,] <span class="ot">&lt;-</span> <span class="fu">Imptest</span>(N,n,X,M,Y,T0[i])</span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Output the table of p-values for the permutation tests above.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Result reporting</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Condition 1&quot;</span>,<span class="st">&quot;Condition 2&quot;</span>,<span class="st">&quot;Condition 3&quot;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha=0,beta=0&quot;</span>,<span class="st">&quot;alpha=0,beta=1&quot;</span>,<span class="st">&quot;alpha=1,beta=0&quot;</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##                Condition 1 Condition 2 Condition 3
## alpha=0,beta=0   0.6943057   0.7012987  0.48451548
## alpha=0,beta=1   0.3526474   0.0000000  0.06793207
## alpha=1,beta=0   0.2207792   0.2227772  0.01198801</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the memory of the variables</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="expit-model" class="section level3">
<h3>Expit model</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input: N,b1,b2,b3,f0</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># output:alpha</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate data</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="cf">function</span>(alpha) <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(alpha<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3))))<span class="sc">-</span>f0 </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="fu">uniroot</span>(p,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">0</span>))</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  ss<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">unlist</span>(s),<span class="dv">5</span>)[<span class="dv">1</span>]</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ss)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>alp<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(f0))</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)){</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  alp[i]<span class="ot">&lt;-</span><span class="fu">g</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">f0=</span>f0,<span class="at">alpha=</span>alp)</span></code></pre></div>
<pre><code>##         f0     alpha
## [1,] 1e-01  -4.54294
## [2,] 1e-02  -6.98866
## [3,] 1e-03  -9.22314
## [4,] 1e-04 -11.43335</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># f0 vs alpha scatter plot</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0,alp,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab=</span><span class="fu">expression</span>(f[<span class="dv">0</span>]),<span class="at">ylab =</span> <span class="fu">expression</span>(alpha))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw9-2022-11-11" class="section level1">
<h1>hw9-2022-11-11</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>One class work, 2.1.3 Exercise 4, 5;2.3.1 Exercise 1, 2; 2.4.5
Exercise 1, 2, 3 (Advanced in R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="em-algorithm" class="section level3">
<h3>EM algorithm</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate $\lambda$ by directly maximizing likelihood function of observed data:</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span>u<span class="sc">+</span><span class="dv">1</span> <span class="co"># observed intervals</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>l_o <span class="ot">&lt;-</span> <span class="cf">function</span>(lam){ <span class="co"># the obseved data likelihood function</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>v))))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">uniroot</span>(l_o,<span class="fu">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.5</span>))<span class="sc">$</span>root,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07196</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate $\lambda$ by using EM algorithm:</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>EM<span class="ot">&lt;-</span><span class="cf">function</span>(lam0,u,v,N,eps){ <span class="co"># lam0: initial value; N: max_iterations</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  lam1<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  lam2<span class="ot">&lt;-</span>lam0</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(u)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(lam1<span class="sc">-</span>lam2)<span class="sc">&gt;=</span>eps){</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    lam1<span class="ot">&lt;-</span>lam2</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    lam2<span class="ot">&lt;-</span>n<span class="sc">/</span><span class="fu">sum</span>(((lam1<span class="sc">*</span>u<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>u)<span class="sc">-</span>(lam1<span class="sc">*</span>v<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>v))<span class="sc">/</span>(lam1<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>v))))</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span>N) <span class="cf">break</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(lam2,<span class="dv">5</span>))</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(<span class="fl">0.5</span>,u,v,<span class="fl">1e5</span>,<span class="fl">1e-3</span>)</span></code></pre></div>
<pre><code>## [1] 0.07197</code></pre>
</div>
</div>
</div>
<div id="hw10-2022-11-18" class="section level1">
<h1>hw10-2022-11-18</h1>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># packages that will be used</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Exercises 2 on page 204,Exercises 1 on page 213 (Advanced R) and
Gibbs Sampler.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="section-16" class="section level3">
<h3>1</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>scale02<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">lapply</span>(x, <span class="cf">function</span>(y) <span class="cf">if</span> (<span class="fu">is.numeric</span>(y)) <span class="fu">scale01</span>(y) <span class="cf">else</span> y))</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="gibbs-sampler" class="section level3">
<h3>Gibbs sampler</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">5e3</span> <span class="co"># length of chain</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="fl">1e3</span> <span class="co"># burn-in length</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">&lt;-</span>mu2<span class="ot">&lt;-</span><span class="dv">0</span> <span class="co"># zero means</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span>sigma2<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># unit standard deviations</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>rho<span class="ot">&lt;-</span><span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../src/gibbsC.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;D:/sc/
## final/StatComp22083/src/../inst/include&quot;: ç³»ç»æ¾ä¸å°æå®çè·¯å¾ã</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>gibbsc<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,N)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbsc,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">main=</span><span class="st">&quot;Generated with Rcpp&quot;</span>,<span class="at">xlab =</span> <span class="st">&#39;Xt&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Yt&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gibbs sampler to generate a bivariate normal chain</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">&lt;-</span><span class="cf">function</span>(mu1,mu2,sigma1,sigma2,rho,N){</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) <span class="co"># for storage</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1 </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate the chain</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(mu1,mu2)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    x2<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">&lt;-</span>mu1<span class="sc">+</span>rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">&lt;-</span>mu2<span class="sc">+</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>gibbsr<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,N)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbsr,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">main=</span><span class="st">&quot;Generated with pure R language&quot;</span>,<span class="at">xlab =</span> <span class="st">&#39;Xt&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Yt&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare by `qqplot`</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compare sample Xt</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsc[,<span class="dv">1</span>],gibbsr[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;Xt&quot;</span>,<span class="at">xlab =</span> <span class="st">&#39;Rcpp&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;R&#39;</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(gibbsc[,<span class="dv">1</span>],<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compare sample Yt</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsc[,<span class="dv">2</span>],gibbsr[,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&quot;Yt&quot;</span>,<span class="at">xlab =</span> <span class="st">&#39;Rcpp&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;R&#39;</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(gibbsc[,<span class="dv">2</span>],<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare the computation time of the two functions</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(gibbsr<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,N),</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                   gibbsc<span class="ot">&lt;-</span><span class="fu">gibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,N))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                                   expr       lq  median       uq
## 1 gibbsr &lt;- gibbsR(0, 0, 1, 1, 0.9, N) 21.16485 24.4339 30.65345
## 2 gibbsc &lt;- gibbsC(0, 0, 1, 1, 0.9, N)  1.13295  1.2383  1.37540</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
